<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Writing cleaner code with the rule of least power #ROLP - YCM Jason</title><meta name="gridsome:hash" content="bde7c0d0e194d22064e098d72a6c5896c46477e3"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Jason loves solving problems. And he plays music."><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.fc1e89df36d8722b28a19d261954e6a2.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.fc1e89df36d8722b28a19d261954e6a2.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.fc1e89df36d8722b28a19d261954e6a2.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.fc1e89df36d8722b28a19d261954e6a2.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.fc1e89df36d8722b28a19d261954e6a2.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.fc1e89df36d8722b28a19d261954e6a2.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.fc1e89df36d8722b28a19d261954e6a2.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.fc1e89df36d8722b28a19d261954e6a2.png"><link rel="preload" href="/assets/css/0.styles.11dff2c8.css" as="style"><link rel="preload" href="/assets/js/app.8ac765a0.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--dev-to-post-vue.a20627f2.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.6d2260cd.js"><link rel="prefetch" href="/assets/js/page--src--pages--articles-vue.11333157.js"><link rel="prefetch" href="/assets/js/page--src--pages--cv-vue.831219f0.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.314436d7.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--articles-vue.5c78b4b6.js"><link rel="stylesheet" href="/assets/css/0.styles.11dff2c8.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout"><a href="https://github.com/ycmjason/ycmjason.com" aria-label="View source on GitHub" class="github-corner" data-v-03ac3be2><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; right: 0;" data-v-03ac3be2><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z" data-v-03ac3be2></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" class="octo-arm" style="transform-origin: 130px 106px;" data-v-03ac3be2></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body" data-v-03ac3be2></path></svg></a><header class="header"><strong class="site-name">YCM Jason</strong><nav class="nav"><a href="/" class="nav__link active">Home</a><a href="/articles/" class="nav__link">Articles</a><a href="/cv/" class="nav__link">CV</a><a href="https://github.com/ycmjason" target="_blank" rel="noopener" class="nav__link">Github</a></nav></header><div class="markdown-body"><h1>Writing cleaner code with the rule of least power #ROLP</h1><div><p><a href="https://www.w3.org/2001/tag/doc/leastPower.html" target="_blank" rel="noopener noreferrer">The rule of least power<OutboundLink/></a> suggests that:</p>
<blockquote>
<p>the less powerful the [computer] language, the more you can do with the data stored in that language.</p>
</blockquote>
<p>An example of this would be <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer#Object_literal_notation_vs_JSON" target="_blank" rel="noopener noreferrer">JSON vs Javascript object literal<OutboundLink/></a>.</p>
<p>Javascript object literal is clearly more powerful:</p>
<ul>
<li>It can have references to variables and native javascript objects, e.g. <code>Set</code>, <code>Map</code>, <code>RegExp</code> and even functions.</li>
<li>It has a more complex syntax, e.g. keys without <code>&quot;</code>, keys with <code>[]</code> to refer to other variables etc.</li>
</ul>
<p>In contrast, <a href="https://www.json.org/json-en.html" target="_blank" rel="noopener noreferrer">JSON<OutboundLink/></a> is much less powerful:</p>
<ul>
<li>It only supports strings, numbers, JSON object, arrays, boolean and <code>null</code>.</li>
<li>You can only define an entry with <code>&quot;property&quot;: ...</code>.</li>
</ul>
<p>Although <a href="https://www.json.org/json-en.html" target="_blank" rel="noopener noreferrer">JSON<OutboundLink/></a> is less powerful, it is much more straight-forward to parse and understand, both by humans and computers.  This is one of the reasons why JSON has become the standard in data transfer nowadays.</p>
<hr>
<p>I learnt about this rule a few years back; but have only recently realised it can also improve the quality of our code.</p>
<p>I would extend the rule of least power, so that it is not only applicable to choices amongst computer languages / systems, but also to choices amongst every line of code we write.</p>
<p>This article uses Javascript in the examples but the principle is applicable to other languages.</p>
<h2 id="abstract"><a class="header-anchor" href="#abstract">#</a> Abstract</h2>
<p>When writing computer programs, one is often faced with a choice between multiple ways to express a condition, or to perform an operation, or to solve some problem. The &quot;Rule of Least Power&quot; (extended) suggests choosing the least powerful way suitable for a given purpose.</p>
<h2 id="expression-power-and-readability"><a class="header-anchor" href="#expression-power-and-readability">#</a> Expression Power and Readability</h2>
<p>Readability of a piece of code has huge impact on maintainability, extensibility, optimisability etc. Readable code is much easier to be analysed, refactored and built on top of. This section explores the connection between the choice of expressions and the readability of a piece of code.</p>
<blockquote>
<p>Principle: Powerful expression inhibits readability.</p>
</blockquote>
<p>The power of an expression can also be thought of as &quot;how much more it can do beyond achieving a specific purpose&quot;.</p>
<hr>
<p>Consider the following example:</p>
<!--beforebegin--><div class="language-js extra-class"><!--afterbegin--><pre v-pre class="language-js"><code><span class="token comment">// More powerful: RegExp.prototype.test</span>
<span class="token operator">/</span>hi<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
<span class="token comment">// Less powerful: String.prototype.includes</span>
str<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p>The first expression <code>/hi/.test(str)</code> is more powerful because you could do so much more with regex. <code>str.includes('hi')</code> is pretty much all <code>String.prototype.includes</code> can do.</p>
<p>The reason why <code>str.includes('hi')</code> is more readable is that it requires no extra thinking to understand it. You can be 100% sure that <code>str.includes(...)</code> will only check if <code>...</code> is a substring of <code>str</code>. In the contrary, <code>/.../.test(str)</code> would require reading into <code>...</code> in order to figure out what it actually does.</p>
<hr>
<p>Consider another example:</p>
<!--beforebegin--><div class="language-js extra-class"><!--afterbegin--><pre v-pre class="language-js"><code><span class="token comment">// More powerful: Array.prototype.reduce</span>
<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token operator">...</span>acc<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Less powerful: Object.fromEntries + Array.prototype.map</span>
Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=></span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p>The same arguments about power and readability apply similarly here. <code>['a', 'b', 'c'].reduce(...)</code> can reduce to literally anything, whereas <code>Object.fromEntries(...)</code> will definitely return an object. Hence, <code>Array.prototype.reduce</code> is more powerful; and <code>Object.fromEntries(...)</code> is more readable.</p>
<h3 id="more-examples"><a class="header-anchor" href="#more-examples">#</a> More examples</h3>
<!--beforebegin--><div class="language-js extra-class"><!--afterbegin--><pre v-pre class="language-js"><code><span class="token comment">// More powerful: RegExp.prototype.test</span>
<span class="token operator">/</span><span class="token operator">^</span>hi$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
<span class="token comment">// Less powerful: ===</span>
str <span class="token operator">===</span> <span class="token string">'hi'</span>

<span class="token comment">// More powerful: RegExp.prototype.test</span>
<span class="token operator">/</span><span class="token operator">^</span>hi<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
<span class="token comment">// Less powerful: String.prototype.startsWith</span>
str<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>

<span class="token comment">// More powerful: RegExp.prototype.test</span>
<span class="token operator">/</span>hi$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
<span class="token comment">// Less powerful: String.prototype.endsWith</span>
str<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>


<span class="token comment">/// More powerful: Array.protype.reduce</span>
xs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=></span> x <span class="token operator">></span> y <span class="token operator">?</span> x <span class="token operator">:</span> y<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">Infinity</span><span class="token punctuation">)</span>
<span class="token comment">// Less powerful: Math.max</span>
Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">...</span>xs<span class="token punctuation">)</span>

<span class="token comment">// More powerful: Array.prototype.reduce</span>
parts<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> part</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>acc<span class="token punctuation">,</span> <span class="token operator">...</span>part <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Less powerful: Object.assign</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">...</span>parts<span class="token punctuation">)</span>


<span class="token comment">// More powerful: Object.assign - can mutate first object</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token comment">// Less powerful: Object spread</span>
<span class="token punctuation">{</span> <span class="token operator">...</span>a<span class="token punctuation">,</span> <span class="token operator">...</span>b <span class="token punctuation">}</span>


<span class="token comment">// More powerful: function - have its own `this`</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token comment">// Less powerful: arrow function</span>
<span class="token keyword">const</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>

<span class="token comment">// More powerful: without destructure - who knows what the function will</span>
<span class="token comment">//                                      do with the universe</span>
<span class="token keyword">const</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">universe</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token comment">// Less powerful - f only needs earth</span>
<span class="token keyword">const</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> earth <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre>
<!--beforeend--></div><!--afterend--><h2 id="depowering"><a class="header-anchor" href="#depowering">#</a> &quot;Depowering&quot;</h2>
<p>At this point, we have established and demonstrated how powerful expression can come with some readability tradeoffs. This section explores the possibility to reduce power of an expression in order to increase readability.</p>
<h3 id="depowering-by-conventions"><a class="header-anchor" href="#depowering-by-conventions">#</a> Depowering by conventions</h3>
<p>The holy trinity of array methods <code>.map</code>, <code>.filter</code> and <code>.reduce</code> were borrowed from functional programming languages where side-effects are not possible.</p>
<p>The freedom, that Javascript and many other languages provide, has made the holy trinity more powerful than they should be. Since there is no limitation about side-effects, they are as powerful as a <code>for</code> or <code>while</code> loop when they shouldn't be.</p>
<!--beforebegin--><div class="language-js extra-class"><!--afterbegin--><pre v-pre class="language-js"><code><span class="token keyword">const</span> xs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> ys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  xs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  ys<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// we can also use map / filter / reduce</span>
<span class="token keyword">const</span> xs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> ys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span> length<span class="token operator">:</span> <span class="token number">1000</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  xs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  ys<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p>The above example demonstrates how the holy trinity are able to do what a <code>for</code> loop is capable of. This extra power, as argued in previous section, incurs readability tradeoffs. The reader would now need to worry about side-effects.</p>
<p>We can dumb down / &quot;depower&quot; <code>.map</code>, <code>.filter</code> and <code>.reduce</code> and make them more readable by reinforcing a &quot;no side-effect&quot; convention.</p>
<!--beforebegin--><div class="language-js extra-class"><!--afterbegin--><pre v-pre class="language-js"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token comment">// returns [f(1), f(2), f(3)] AND DO NOTHING ELSE</span>
xs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token comment">// returns a subset of xs where all the elements satisfy f AND DO NOTHING ELSE</span>
xs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token comment">// reduce to something AND DO NOTHING ELSE</span>
</code></pre>
<!--beforeend--></div><!--afterend--><hr>
<p><code>.reduce</code> is the most powerful comparing the other two. In fact, you can define the other two with <code>.reduce</code>:</p>
<!--beforebegin--><div class="language-js extra-class"><!--afterbegin--><pre v-pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">map</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">xs<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token operator">=></span> xs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> x</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span><span class="token operator">...</span>acc<span class="token punctuation">,</span> <span class="token function">fn</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">filter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">xs<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token operator">=></span> xs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> x</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">fn</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token operator">...</span>acc<span class="token punctuation">,</span> x<span class="token punctuation">]</span> <span class="token operator">:</span> acc<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p>Due to this power, I personally like another convention to further depower <code>.reduce</code>. The convention is to always reduce to the type of the elements of the array.</p>
<p>For Example, an array of numbers should try to always reduce to a number.</p>
<!--beforebegin--><div class="language-js extra-class"><!--afterbegin--><pre v-pre class="language-js"><code>xs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=></span> x <span class="token operator">+</span> y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// ✅</span>

people<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p1<span class="token punctuation">,</span> p2</span><span class="token punctuation">)</span> <span class="token operator">=></span> p1<span class="token punctuation">.</span>age <span class="token operator">+</span> p2<span class="token punctuation">.</span>age<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// ❌</span>

people
<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> age <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> age<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=></span> x <span class="token operator">+</span> y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// ✅</span>
</code></pre>
<!--beforeend--></div><!--afterend--><h3 id="depowering-by-abstractions"><a class="header-anchor" href="#depowering-by-abstractions">#</a> Depowering by abstractions</h3>
<p>Abstractions are a good way to depower expressions. An abstraction could be a function, data structure or even types. The idea is to hide some power under the abstraction, exposing only what is needed for the specific purpose.</p>
<hr>
<p>A great example would be the popular <a href="https://github.com/pillarjs/path-to-regexp" target="_blank" rel="noopener noreferrer">Path-to-RegExp<OutboundLink/></a> library. This library hide the power of the almighty RegExp, exposing an API specific for path matching.</p>
<p>For example</p>
<!--beforebegin--><div class="language-ts extra-class"><!--afterbegin--><pre v-pre class="language-ts"><code><span class="token function">pathToRegExp</span><span class="token punctuation">(</span><span class="token string">'/hello/:name'</span><span class="token punctuation">)</span>
<span class="token comment">// will be compiled to</span>
<span class="token operator">/</span><span class="token operator">^</span>\<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">hello\/(?:([^\/]+?))\/?$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span>
</code></pre>
<!--beforeend--></div><!--afterend--><hr>
<p>Here is a more advanced example.</p>
<!--beforebegin--><div class="language-ts extra-class"><!--afterbegin--><pre v-pre class="language-ts"><code><span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>x <span class="token operator">&amp;&amp;</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span>y <span class="token operator">&amp;&amp;</span> <span class="token function">g</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p><code>!!x &amp;&amp; f(x)</code> is common pattern to make sure <code>x</code> is truthy before calling <code>f(x)</code>. The <code>&amp;&amp;</code> operator can definitely do more than just that, as there is no restriction about what you can put on either side of <code>&amp;&amp;</code>.</p>
<p>A way to abstract this is the famous data structure: <code>Maybe</code> aka <a href="https://en.wikipedia.org/wiki/Option_type" target="_blank" rel="noopener noreferrer"><code>Option</code><OutboundLink/></a>. Below is a super naive <strong>non-practical</strong> implementation:</p>
<!--beforebegin--><div class="language-ts extra-class"><!--afterbegin--><pre v-pre class="language-ts"><code><span class="token comment">// Maybe a = Just a | Nothing</span>
<span class="token keyword">const</span> <span class="token function-variable function">Maybe</span> <span class="token operator">=</span> x <span class="token operator">=></span> <span class="token operator">!</span><span class="token operator">!</span>x <span class="token operator">?</span> <span class="token function">Just</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Nothing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">Just</span> <span class="token operator">=</span> x <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">map</span><span class="token operator">:</span> f <span class="token operator">=></span> <span class="token function">Maybe</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">Nothing</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">map</span><span class="token operator">:</span> f <span class="token operator">=></span> <span class="token function">Nothing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p><em>Yes! Maybe is a functor</em></p>
<p>With this abstraction, we can write the following instead:</p>
<!--beforebegin--><div class="language-ts extra-class"><!--afterbegin--><pre v-pre class="language-ts"><code><span class="token keyword">return</span> <span class="token function">Maybe</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p>In this example, <code>Maybe</code> hides away the <code>&amp;&amp;</code> it is doing internally, giving confidence to readers that <code>f</code> and <code>g</code> can be safely executed, or ignored depending on <code>x</code> and <code>f(x)</code>.</p>
<p>If you are interested in learning more about data structures like this, take this <a href="https://egghead.io/courses/professor-frisby-introduces-composable-functional-javascript" target="_blank" rel="noopener noreferrer">course<OutboundLink/></a> I found on egghead. It goes through fundamental functional programming concepts in a fun and engaging way! Totally recommend!</p>
<hr>
<p>The last example is depowering via types. I will use typescript to demonstrate.</p>
<!--beforebegin--><div class="language-ts extra-class"><!--afterbegin--><pre v-pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Person</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span>
  weight<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token comment">// More powerful - is f going to do anything with the person?</span>
<span class="token keyword">const</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span>person<span class="token operator">:</span> Person<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token comment">// Less powerful - f only needs the name. But will it mutate it?</span>
<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token punctuation">(</span>person<span class="token operator">:</span> Pick<span class="token operator">&lt;</span>Person<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token comment">// Even less powerful - f only reads the name from the person</span>
<span class="token keyword">const</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span>person<span class="token operator">:</span> Readonly<span class="token operator">&lt;</span>NamedThing<span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre>
<!--beforeend--></div><!--afterend--><h2 id="pinch-of-salt"><a class="header-anchor" href="#pinch-of-salt">#</a> Pinch of salt</h2>
<p>Please take the advice in this article with a pinch of salt.</p>
<p>This article highlights my formalisation about the relationship between the power of an expression and readability. And ways that we can depower expressions to increase readability.</p>
<p>There are still many factors contributes towards the readability of a piece of code besides the power of expressions. Do not blindly choose the less powerful expression. Do not &quot;depower&quot; every line of code into a function call. Do not put every variables into <code>Maybe</code>.</p>
<p>I am still in constant discovery and theorization on the topic of &quot;good code&quot;. My mind might change over time. But ever since I introduced this idea to my team, we have not found a single instance where this rule fails. We even start using <code>#ROLP</code> (<strong>R</strong>ule <strong>O</strong>f <strong>L</strong>east <strong>P</strong>ower) to reason about why one code is better than the other. So my faith is strong here, and is growing every day.</p>
<p>I hope the rule of least power (extended) can inspire you to produce better code in the future! Please experiment with it and let me know what you think!</p>
</div></div><footer>Copyright © 2021 Jason Yu</footer></div>
    <script src="/assets/js/app.8ac765a0.js" defer></script><script src="/assets/js/page--src--templates--dev-to-post-vue.a20627f2.js" defer></script>
  </body>
</html>
